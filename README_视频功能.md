# 视频上传功能说明

## 新增功能

在原有的摄像头监控基础上，新增了本地视频文件上传和播放功能。

## 功能特点

### 1. 支持多种视频格式
- **常见格式**: MP4, AVI, MOV, MKV, WMV, FLV
- **网络格式**: WebM, M4V
- **移动设备格式**: 3GP
- **专业格式**: MPG, MPEG, TS, MTS, M2TS
- **其他格式**: 支持所有文件类型

### 2. 界面更新
- 在左侧控制面板新增了两个按钮：
  - **"上传本地视频文件"**: 用于选择视频文件
  - **"播放视频文件"**: 用于播放已选择的视频文件

### 3. 智能状态管理
- 选择视频文件后，播放按钮自动启用
- 按钮文字会显示已选择的文件名（超过20字符会截断）
- 摄像头和视频播放模式互斥，切换时会自动停止另一个

## 使用方法

### 步骤1: 上传视频文件
1. 点击"上传本地视频文件"按钮
2. 在弹出的文件对话框中选择要分析的视频文件
3. 选择完成后，按钮文字会更新显示文件名

### 步骤2: 播放视频
1. 点击"播放视频文件"按钮
2. 系统会自动关闭摄像头（如果正在运行）
3. 开始播放视频并进行行为检测

### 步骤3: 行为检测
- 视频播放时会实时进行姿态检测
- 支持检测的行为包括：
  - 站立 (stand)
  - 坐下 (sit)
  - 行走 (walk)
  - 举手 (L_hand up / R_hand up)

### 步骤4: 计时统计
- 可以同时进行计时和计数功能
- 统计信息会实时更新在界面上

## 技术实现

### 1. 多线程处理
- 视频处理在独立线程中进行，避免界面卡顿
- 使用线程安全的状态管理

### 2. 帧率控制
- 根据视频原始帧率控制播放速度
- 保持视频播放的流畅性

### 3. 模型复用
- 使用相同的YOLO模型进行姿态检测
- 保持检测精度的一致性

### 4. 内存管理
- 及时释放视频资源
- 避免内存泄漏

## 注意事项

1. **文件大小**: 建议视频文件不要过大，以免影响处理速度
2. **格式兼容**: 某些特殊编码的视频可能无法正常播放
3. **性能要求**: 视频处理需要一定的计算资源，建议在性能较好的设备上运行
4. **存储空间**: 确保有足够的存储空间用于临时文件

## 故障排除

### 问题1: 无法打开视频文件
- 检查文件路径是否正确
- 确认文件格式是否支持
- 检查文件是否损坏

### 问题2: 视频播放卡顿
- 降低视频分辨率
- 关闭其他占用资源的程序
- 检查设备性能

### 问题3: 检测效果不佳
- 确保视频中人物清晰可见
- 检查光线条件
- 调整检测置信度阈值

## 更新日志

- **v2.0**: 新增视频上传和播放功能
- 支持多种视频格式
- 优化用户界面
- 改进错误处理 